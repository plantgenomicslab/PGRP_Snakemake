// resources-slurm.config â€” process resources & Slurm executor
// Load with: -c resources-slurm.config

process {
  executor       = 'slurm'
  queue          = 'batch'          // change to your partition
  errorStrategy  = 'retry'
  maxRetries     = 2
  maxForks       = 50               // throttle concurrent jobs

  // Lightweight helpers
  withName: 'READ_SAMPLES'      { cpus = 1;  memory = '1 GB';  time = '10m' }
  withName: 'CHECK_REFERENCES'  { cpus = 1;  memory = '1 GB';  time = '10m' }

  // Ingest
  withName: 'FETCH_SRA'         { cpus = 4;  memory = '8 GB';  time = '2h' }
  withName: /SRA_TO_FASTQ_.*/   { cpus = 8;  memory = '16 GB'; time = '4h' }
  withName: /IMPORT_RAW_.*/     { cpus = 1;  memory = '1 GB';  time = '30m' }

  // QC & trimming
  withName: /FASTQC_.*/         { cpus = 4;  memory = '8 GB';  time = '1h' }
  withName: /TRIM_.*/           { cpus = 8;  memory = '16 GB'; time = '2h' }

  // Alignment & merges
  withName: /STAR_ALIGN_.*/     { cpus = 16; memory = '32 GB'; time = '12h' }
  withName: 'MERGE_STAR_BY_REP' { cpus = 8;  memory = '16 GB'; time = '2h' }

  // RSEM path
  withName: /STAR_ALIGN_RSEM_.*/{ cpus = 16; memory = '32 GB'; time = '12h' }
  withName: 'MERGE_RSEM_BY_REP' { cpus = 8;  memory = '16 GB'; time = '2h' }
  withName: 'RSEM_CALC'         { cpus = 12; memory = '24 GB'; time = '8h' }

  // Counting backends
  withName: 'FEATURECOUNTS'     { cpus = 12; memory = '16 GB'; time = '4h' }
  withName: 'HTSEQ_COUNT'       { cpus = 12; memory = '24 GB'; time = '6h' }
  withName: 'TPMCALC'           { cpus = 8;  memory = '16 GB'; time = '3h' }
  withName: 'MERGE_TPMCALC'     { cpus = 4;  memory = '8 GB';  time = '1h' }

  // Normalization/Summary
  withName: /NORMALIZE_.*/      { cpus = 4;  memory = '8 GB';  time = '1h' }
  withName: /SUMMARIZE_.*/      { cpus = 2;  memory = '4 GB';  time = '30m' }

  // DEG
  withName: /DEG_.*/            { cpus = 8;  memory = '32 GB'; time = '8h' }

  // Optional Slurm flags (uncomment & edit)
  // clusterOptions = '--account=YOUR_ACC --partition=YOUR_PART --qos=YOUR_QOS'
}

executor {
  name = 'slurm'
  submitRateLimit = '10 sec'
}
